Same as part1 but includes a subtract function
