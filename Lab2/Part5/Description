Same as part 4. But following the algorithm given.
